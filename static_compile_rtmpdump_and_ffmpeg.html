<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
  <head>
    <title>静态编译rtmpdump+ffmpeg - 光明顶</title>
    <link href="http://fonts.googleapis.com/css?family=Arimo:400,700|Inika" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="http://blog.hhyue.com/theme/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="http://blog.hhyue.com/theme/pastie.css" />
    <link href="http://blog.hhyue.com/" type="application/atom+xml" rel="alternate" title="光明顶 Atom Feed" />


  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="span8">
<div id="content">
    <div class="header">
        <h1>静态编译rtmpdump+ffmpeg</h1>
    </div>
    <p class="meta"><small><span><a href="http://blog.hhyue.com/author/hhyue/">hhyue</a> - </span><span>2013-08-03 20:20:00</span> - <span class="tags"><a href="/tag/rtmp/">rtmp</a>, <a href="/tag/ffmpeg/">ffmpeg</a></span></small></p>
        <div class="entry-content">
        <p>废话不多说, 直接上编译脚本, debian 7.1 amd64上测试通过:</p>
<div class="highlight"><pre>BUILD_DIR=<span class="nv">$HOME</span>/work/ffmpeg/build
BIN_DIR=<span class="nv">$HOME</span>/work/ffmpeg/bin

#zlib
wget http://zlib.net/zlib-1.2.8.tar.gz
tar -zxvf zlib-1.2.8.tar.gz
cd zlib-1.2.8
./configure --prefix=<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span> --static
make -j2
make install
cd ..

#openssl
wget http://www.openssl.org/source/openssl-1.0.1e.tar.gz
tar -zxvf openssl-1.0.1e.tar.gz
cd openssl-1.0.1e
./config --prefix=<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span> --openssldir=<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span>/openssl no-shared zlib
make -j2
make install
cd ..

#rtmpdump
wget http://rtmpdump.mplayerhq.hu/download/rtmpdump-2.3.tgz
tar -zxvf rtmpdump-2.3.tgz
cd rtmpdump-2.3
make prefix=<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span> SYS=posix SHARED= XLDFLAGS=-L<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span>/lib XLIBS=-  ldl
make install prefix=<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span> SYS=posix SHARED= XLDFLAGS=-L<span class="cp">${</span><span class="n">BUILD_DIR</span><span class="cp">}</span>/lib XLIBS=-ldl
cd ..

#yasm
wget http://www.tortall.net/projects/yasm/releases/yasm-1.2.0.tar.gz yasm-1.2.0.tar.gz
tar -zxvf yasm-1.2.0.tar.gz
cd yasm-1.2.0
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --bindir=&quot;<span class="nv">$BIN_DIR</span>&quot;
make -j2
make install
make distclean
export PATH=<span class="cp">${</span><span class="n">BIN_DIR</span><span class="cp">}</span>:<span class="cp">${</span><span class="n">PATH</span><span class="cp">}</span>
#. ~/.bash_profile
cd ..

#x264
git clone --depth 1 git://git.videolan.org/x264.git
cd x264
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --bindir=&quot;<span class="nv">$BIN_DIR</span>&quot; --enable-static
make -j2
make install-lib-static
make distclean
cd ..

#fdk_aac
git clone --depth 1 git://github.com/mstorsjo/fdk-aac.git
cd fdk-aac
automake --add-missing
autoreconf -fiv
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --disable-shared
make -j2
make install
make distclean
cd ..

#mp3lame
wget http://downloads.sourceforge.net/project/lame/lame/3.99/lame-3.99.5.tar.gz lame-    3.99.5.tar.gz
tar xzvf lame-3.99.5.tar.gz
cd lame-3.99.5
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --bindir=&quot;<span class="nv">$BIN_DIR</span>&quot; --disable-shared --enable-nasm
make -j2
make install
make distclean
cd ..

#opus
wget http://downloads.xiph.org/releases/opus/opus-1.0.2.tar.gz
tar -zxvf opus-1.0.2.tar.gz
cd opus-1.0.2
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --disable-shared
make -j2
make install
make distclean
cd ..

#ogg
wget http://downloads.xiph.org/releases/ogg/libogg-1.3.1.tar.gz
tar -zxvf libogg-1.3.1.tar.gz
cd libogg-1.3.1
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --disable-shared
make -j2
make install
make distclean
cd ..

#vorbis
wget http://downloads.xiph.org/releases/vorbis/libvorbis-1.3.3.tar.gz
tar -zxvf libvorbis-1.3.3.tar.gz
cd libvorbis-1.3.3
./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --with-ogg=&quot;<span class="nv">$BUILD_DIR</span>&quot; --disable-shared
make -j2
make install
make distclean
cd ..

#vpx
#git clone --depth 1 http://git.chromium.org/webm/libvpx.git
#cd libvpx
#./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --disable-examples
#make -j2
#make install
#make clean

#ffmpeg
wget http://www.ffmpeg.org/releases/ffmpeg-1.2.3.tar.gz
tar -zxvf ffmpeg-1.2.3.tar.gz
cd ffmpeg-1.2.3
PKG_CONFIG_PATH=&quot;<span class="nv">$BUILD_DIR</span>/lib/pkgconfig&quot; ./configure --prefix=&quot;<span class="nv">$BUILD_DIR</span>&quot; --extra-cflags=&quot;-I<span class="nv">$BUILD_DIR</span>/include&quot; --extra-ldflags=&quot;-L<span class="nv">$BUILD_DIR</span>/lib&quot; --bindir=&quot;<span class="nv">$BIN_DIR</span>&quot; --extra-libs=&quot;-ldl&quot; --enable-gpl --enable-nonfree --enable-libfdk_aac --enable-libmp3lame --enable-libopus --enable-libvorbis --enable-libx264 --enable-librtmp
make -j2
make install
hash -r
#. ~/.bash_profile
</pre></div>
        </div><!-- /.entry-content -->
</div>
        </div>
        <div class="span3 offset1">
          <div class="well">
            <ul class="nav nav-list">
              <li class="nav-header">Blog</li>
              <li ><a href="http://blog.hhyue.com">Index</a></li>
              <li ><a href="http://blog.hhyue.com/tags.html">Tags</a></li>
              <li ><a href="http://blog.hhyue.com/archives.html">Archiv</a></li>
              <li class="nav-header">Links</li>
              <li><a href="http://getpelican.com/">Pelican</a></li>
              <li><a href="http://python.org/">Python.org</a></li>
              <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
            </ul>
          </div><!-- /#menu -->
        </div>
      </div>

      <hr />

      <div class="row">
        <div class="span12">
          <div id="about">
            <p>Proudly powered by <a href="http://twitter.github.com/bootstrap/">bootstrap</a>, <a href="http://docs.notmyidea.org/alexis/pelican/">pelican</a>, <a href="http://python.org">python</a> and <a href="http://www.julo.ch/about/">Alex</a>!</p>
          </div><!-- /#about -->
        </div><!-- /#contentinfo -->
      </div>
    </div>


  </body>
</html>